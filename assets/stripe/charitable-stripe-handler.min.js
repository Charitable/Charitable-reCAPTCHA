!function(e){var r=jQuery("body"),t=function(e){e.__proto__.hasOwnProperty("add_pending_process")?e.add_pending_process("stripe"):e.pause_processing=!0},n=function(e){e.__proto__.hasOwnProperty("remove_pending_process")?e.remove_pending_process("stripe"):e.pause_processing=!1},_=function(){CHARITABLE.Donation_Form.prototype.is_valid_card_number=function(){return Stripe.card.validateCardNumber(this.get_cc_number().replace(/ /g,""))};Stripe.setPublishableKey(CHARITABLE_STRIPE_VARS.key),r.on("charitable:form:validate",function(e,r){var _=r.get_cc_number(),i=r.get_cc_cvc(),o=r.get_cc_expiry_month(),a=r.get_cc_expiry_year();r.clear_cc_fields(),"stripe"===r.get_payment_method()&&(e.preventDefault(),Stripe.card.validateExpiry(o,a)||r.add_error(CHARITABLE_VARS.error_invalid_cc_expiry),0===r.errors.length&&(t(r),Stripe.card.createToken({number:_,cvc:i,exp_month:o,exp_year:a},function(e,t){var _,i;i=r,(_=t).error?i.add_error(_.error.message):(i.get_input("stripe_token").val(_.id),n(i))})))})};r.on("charitable:form:initialize",function(e){var i,o,a;"checkout"===CHARITABLE_STRIPE_VARS.mode?(o=!1,a=StripeCheckout.configure({key:CHARITABLE_STRIPE_VARS.key,image:"",locale:"auto",token:function(e){o=!0,i.get_input("stripe_token").val(e.id),n(i)},closed:function(){!0!==o&&i.hide_processing()}}),r.on("charitable:form:validate",function(e,r){if("stripe"===(i=r).get_payment_method()&&0===i.errors.length){var n=CHARITABLE_STRIPE_VARS.zero_decimal?i.get_amount():100*i.get_amount();t(i),a.open({name:CHARITABLE_STRIPE_VARS.site_name,description:i.get_description(),email:i.get_email(),currency:CHARITABLE_STRIPE_VARS.currency,amount:n})}})):_()})}();